module(load="imudp")
module(load="imtcp")

input(type="imudp" port="514" ruleset="remote")
input(type="imtcp" port="514" ruleset="remote")

template(name="DataPath" type="list") {
  constant(value="/var/log/")
  property(name="hostname")
  constant(value=".log")
}

template(name="RawOutput" type="string" string="%rawmsg%\n")

ruleset(name="remote") {
  action(
    type="omfile"
    dynaFile="DataPath"
    template="RawOutput"
    fileOwner="root"
    fileGroup="root"
    fileCreateMode="0600"
  )
}
